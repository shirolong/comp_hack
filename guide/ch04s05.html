<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Release Process</title><link rel="stylesheet" type="text/css" href="static/docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="COMP_hack: The Definitive Guide" /><link rel="up" href="ch04.html" title="Chapter 4. Hacker's Guide" /><link rel="prev" href="ch04s04.html" title="Object Generator (objgen)" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Release Process</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch04s04.html">Prev</a> </td><th width="60%" align="center">Chapter 4. Hacker's Guide</th><td width="20%" align="right"> </td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp46852518469344"></a>Release Process</h2></div></div></div><p>The following section describes the process to go through for making a new release.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp46852518470496"></a>Clean Project</h3></div></div></div><p>Go through the project and do the following:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Make sure any issues tagged for this release are resolved or moved to another milestone.</p></li><li class="listitem"><p>Ensure the latest build passed.</p></li><li class="listitem"><p>Run any applicable test suites on the latest build and make sure it passes.</p></li><li class="listitem"><p>Clean up the <a class="ulink" href="https://github.com/comphack/comp_hack/projects/1" target="_top">Server Releases</a> project on GitHub.</p></li><li class="listitem"><p>Ensure the milestone has no open issues and close it.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp46852514992640"></a>Patch Notes</h3></div></div></div><p>Go through the commits and compile a list of what has changed (new features, bug fixes, etc). This list will need to be added into the Debian package (<span class="emphasis"><em>debian/changelog</em></span> file, release entry on GitHUb and the Discord announcement).</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp46852514994768"></a>Update Documentation</h3></div></div></div><p>The Doxygen generated API documentation should be downloaded from the AppVeyor release. The guide should be generated local on a Linux machine. Once all the documentation is generated, clone the <a class="ulink" href="https://github.com/comphack/comphack.github.io" target="_top">comphack.github.io</a> repository. Remove any existing documentation files and add in the new files for a new commit. This should update the website.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp46852514997248"></a>Update Version Information</h3></div></div></div><p>Go into the top of the main <span class="emphasis"><em>CMakeLists.txt</em></span> and change the version to match the release about to be created.</p><p>Confirm that the <span class="emphasis"><em>contrib/sources.sh</em></span> zip files match those listed in <span class="emphasis"><em>cmake/external.cmake</em></span> or the Debian build may fail.</p><p>Create a new entry in the Debian package (<code class="code">debchange -i</code>). Make sure to include the change log items. The format of this file is very picky. It would be good to do a local test build before pushing this to the PPA with this command:</p><pre class="programlisting">
dpkg-buildpackage -us -uc
</pre><p>When making the commit it's a good idea to describe the commit as the version intended as we are about to tag and branch it.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp46852506073520"></a>Test Packages</h3></div></div></div><p>Test both the Debian packages and the MSI produced by AppVeyor. If the version information is wrong or something is not working right, go fix it now.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp46852506075152"></a>Tag &amp; Release</h3></div></div></div><p>Go onto GitHub and create a new pre-release. This will create a new tag. Please use the format from previous releases. This should be "v" followed by the version with a dash and then the release name. If this is a service pack or hotfix add another dash and the appropriate information (for example "-sp1" or "-hotfix1"). Title the release as shown in previous releases and include the change log. <span class="strong"><strong>Make sure the release points to the right branch and commit.</strong></span>. It's especially important that the tag and branch are correct if last minute changes are made and the release is re-created multiple times.</p><p>After they pass, download the tagged version of the AppVeyor build. Rename to match (if wrong) before uploading to the release. Include the Windows zip and msi builds. The documentation build can be included too but is not required.</p><p>Tag the datastore repository to match.</p><p>After the PPA is updated as well, download and test the release build. Once it looks OK set it to an official release.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp46852505980928"></a>Update PPA</h3></div></div></div><p>Update the PPA with the new Debian build. Clone the correct version of the code, download the source to the dependencies and remove the git history. Upload to the PPA and ensure the build completes and the packages are published. Test the published packages and make fixes as needed. Here is an example flow (you may need to change some things):</p><pre class="programlisting">
git clone -b v3.1.0-lilim-sp1 git@github.com:comphack/comp_hack.git
cd comp_hack/
git submodule update --init
rm -rf .git
contrib/sources.sh
debuild -S -sa
cd ..
dput ppa:compomega/comphack *.changes
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp46852505983808"></a>Create Branch</h3></div></div></div><p>First, merge the <span class="emphasis"><em>develop</em></span> branch into <span class="emphasis"><em>master</em></span>. This should be a clean fast-forward. If this is a major release, create the appropriately named branch off of <span class="emphasis"><em>develop</em></span>. Bug fixes and other changes for a service pack or hot fixes should go into this branch from now on.</p><p>Go to the <span class="emphasis"><em>develop</em></span> branch and change the version back to unstable with a new commit. This way nobody forgets to change it and makes test builds as a release!</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp46852505987856"></a>Announce Release</h3></div></div></div><p>Announce the release on Discord and wherever else is appropriate. Be sure to include the change log of cool new features to get everyone excited. Party hard.</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch04s04.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch04.html">Up</a></td><td width="40%" align="right"> </td></tr><tr><td width="40%" align="left" valign="top">Object Generator (objgen) </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>